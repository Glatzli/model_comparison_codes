<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/calculations_and_plots/Inn_valley_pressure_tendency.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/calculations_and_plots/Inn_valley_pressure_tendency.py" />
              <option name="originalContent" value="&quot;&quot;&quot;&#10;Calculate pressure tendency along the Inn valley using ZAMG station data.&#10;&#10;This script reads pressure data from three ZAMG stations (Kufstein, Jenbach, and Innsbruck University)&#10;and calculates the pressure tendency (dP/dt) for each station.&#10;&#10;Stations are ordered from east to west along the Inn valley:&#10;1. Kufstein (eastmost, lower Inn valley)&#10;2. Jenbach (middle)&#10;3. Innsbruck University (westmost, upper Inn valley)&#10;&quot;&quot;&quot;&#10;&#10;import pandas as pd&#10;import matplotlib.pyplot as plt&#10;import confg&#10;&#10;&#10;&#10;def calculate_pressure_tendency(df, window='1H'):&#10;    &quot;&quot;&quot;&#10;    Calculate pressure tendency (dP/dt) from pressure time series.&#10;&#10;    Parameters&#10;    ----------&#10;    df : pd.DataFrame&#10;        DataFrame with pressure data&#10;    window : str&#10;        Time window for calculating tendency (default: '1H' = 1 hour)&#10;&#10;    Returns&#10;    -------&#10;    pd.Series&#10;        Pressure tendency in hPa/h&#10;    &quot;&quot;&quot;&#10;    # ZAMG data has 'P' for station pressure and 'P0' for reduced pressure&#10;    # We'll use 'P' (station pressure) for the analysis&#10;    pressure_col = 'P' if 'P' in df.columns else None&#10;&#10;    if pressure_col is None:&#10;        # Try P0 as fallback&#10;        pressure_col = 'P0' if 'P0' in df.columns else None&#10;&#10;    if pressure_col is None:&#10;        raise ValueError(&quot;Could not find pressure column (P or P0) in data&quot;)&#10;&#10;    # Calculate pressure tendency using finite differences&#10;    # Rolling window for smoothing if desired&#10;    pressure = df[pressure_col]&#10;&#10;    # Calculate time derivative (hPa per hour)&#10;    dt_hours = df.index.to_series().diff().dt.total_seconds() / 3600  # Convert to hours&#10;    dp = pressure.diff()&#10;    dp_dt = dp / dt_hours&#10;&#10;    # Optional: apply rolling mean for smoothing&#10;    # dp_dt_smooth = dp_dt.rolling(window=window, center=True).mean()&#10;&#10;    return dp_dt, pressure&#10;&#10;&#10;def plot_pressure_tendency(stations_data, save_path=None):&#10;    &quot;&quot;&quot;&#10;    Plot pressure and pressure tendency for all stations.&#10;&#10;    Parameters&#10;    ----------&#10;    stations_data : dict&#10;        Dictionary with station names as keys and (pressure_tendency, pressure) tuples as values&#10;    save_path : str, optional&#10;        Path to save the figure&#10;    &quot;&quot;&quot;&#10;    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 10), sharex=True)&#10;&#10;    colors = {'Kufstein': 'blue', 'Jenbach': 'green', 'Innsbruck Uni': 'red'}&#10;&#10;    # Plot pressure&#10;    for station_name, (dp_dt, pressure) in stations_data.items():&#10;        ax1.plot(pressure.index, pressure.values, label=station_name,&#10;                color=colors.get(station_name, 'black'), linewidth=2)&#10;&#10;    ax1.set_ylabel('Pressure [hPa]', fontsize=12)&#10;    ax1.set_title('Surface Pressure along the Inn Valley', fontsize=14, fontweight='bold')&#10;    ax1.legend(loc='best')&#10;    ax1.grid(True, alpha=0.3)&#10;&#10;    # Plot pressure tendency&#10;    for station_name, (dp_dt, pressure) in stations_data.items():&#10;        ax2.plot(dp_dt.index, dp_dt.values, label=station_name,&#10;                color=colors.get(station_name, 'black'), linewidth=2)&#10;&#10;    ax2.set_ylabel('Pressure Tendency [hPa/h]', fontsize=12)&#10;    ax2.set_xlabel('Time', fontsize=12)&#10;    ax2.set_title('Pressure Tendency (dP/dt) along the Inn Valley', fontsize=14, fontweight='bold')&#10;    ax2.legend(loc='best')&#10;    ax2.grid(True, alpha=0.3)&#10;    ax2.axhline(y=0, color='black', linestyle='--', alpha=0.5)&#10;&#10;    plt.tight_layout()&#10;&#10;    if save_path:&#10;        plt.savefig(save_path, dpi=300, bbox_inches='tight')&#10;        print(f&quot;Figure saved to: {save_path}&quot;)&#10;&#10;    plt.show()&#10;&#10;    return fig&#10;&#10;&#10;&#10;&#10;if __name__ == &quot;__main__&quot;:&#10;    &quot;&quot;&quot;&#10;    Main function to calculate and plot pressure tendency along Inn valley.&#10;    &quot;&quot;&quot;&#10;    print(&quot;Reading ZAMG station data...&quot;)&#10;&#10;    # Define stations with their file paths and names&#10;    stations = {&#10;        'Kufstein': confg.kufstein_zamg,&#10;        'Jenbach': confg.jenbach_zamg,&#10;        'Innsbruck Uni': confg.innsbruck_uni_zamg&#10;    }&#10;&#10;    # Dictionary to store results&#10;    stations_data = {}&#10;&#10;    # Read and process each station&#10;    for station_name, filepath in stations.items():&#10;        print(f&quot;\nProcessing {station_name}...&quot;)&#10;        try:&#10;            # Read CSV file with comma separator&#10;            df = pd.read_csv(filepath, sep=',', parse_dates=['time'], index_col='time')&#10;            print(f&quot;  Columns available: {df.columns.tolist()}&quot;)&#10;&#10;            # Subset to specific time range&#10;            df_subset = df.loc['2017-10-15 12:00:00':'2017-10-16 12:00:00']&#10;            # Select only rows at 00 and 30 minute marks (no averaging)&#10;            df_30min = df_subset[df_subset.index.to_series().dt.minute.isin([0, 30])]&#10;            print(f&quot;  Data points at 30min intervals: {len(df_30min)}&quot;)&#10;&#10;            # Calculate pressure tendency&#10;            dp_dt, pressure = calculate_pressure_tendency(df_30min)&#10;            stations_data[station_name] = (dp_dt, pressure)&#10;&#10;            # Print some statistics&#10;            print(f&quot;  Time range: {df.index[0]} to {df.index[-1]}&quot;)&#10;            print(f&quot;  Mean pressure: {pressure.mean():.2f} hPa&quot;)&#10;            print(f&quot;  Mean pressure tendency: {dp_dt.mean():.4f} hPa/h&quot;)&#10;            if not dp_dt.dropna().empty:&#10;                print(f&quot;  Max pressure tendency: {dp_dt.dropna().max():.4f} hPa/h&quot;)&#10;                print(f&quot;  Min pressure tendency: {dp_dt.dropna().min():.4f} hPa/h&quot;)&#10;&#10;        except Exception as e:&#10;            print(f&quot;  Error processing {station_name}: {str(e)}&quot;)&#10;            continue&#10;&#10;    # Plot results&#10;    if stations_data:&#10;        print(&quot;\nCreating plots...&quot;)&#10;        save_path = confg.dir_PLOTS + &quot;/Inn_valley_pressure_tendency.png&quot;&#10;        plot_pressure_tendency(stations_data, save_path=save_path)&#10;    else:&#10;        print(&quot;No data to plot!&quot;)&#10;&#10;" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;Calculate pressure tendency along the Inn valley using ZAMG station data.&#10;&#10;This script reads pressure data from three ZAMG stations (Kufstein, Jenbach, and Innsbruck University)&#10;and calculates the pressure tendency (dP/dt) for each station.&#10;&#10;Stations are ordered from east to west along the Inn valley:&#10;1. Kufstein (eastmost, lower Inn valley)&#10;2. Jenbach (middle)&#10;3. Innsbruck University (westmost, upper Inn valley)&#10;&quot;&quot;&quot;&#10;&#10;import pandas as pd&#10;import matplotlib.pyplot as plt&#10;import confg&#10;&#10;&#10;&#10;def calculate_pressure_tendency(df, window='1H'):&#10;    &quot;&quot;&quot;&#10;    Calculate pressure tendency (dP/dt) from pressure time series.&#10;&#10;    Parameters&#10;    ----------&#10;    df : pd.DataFrame&#10;        DataFrame with pressure data&#10;    window : str&#10;        Time window for calculating tendency (default: '1H' = 1 hour)&#10;&#10;    Returns&#10;    -------&#10;    pd.Series&#10;        Pressure tendency in hPa/h&#10;    &quot;&quot;&quot;&#10;    # ZAMG data has 'P' for station pressure and 'P0' for reduced pressure&#10;    # We'll use 'P' (station pressure) for the analysis&#10;    pressure_col = 'P' if 'P' in df.columns else None&#10;&#10;    if pressure_col is None:&#10;        # Try P0 as fallback&#10;        pressure_col = 'P0' if 'P0' in df.columns else None&#10;&#10;    if pressure_col is None:&#10;        raise ValueError(&quot;Could not find pressure column (P or P0) in data&quot;)&#10;&#10;    # Calculate pressure tendency using finite differences&#10;    # Rolling window for smoothing if desired&#10;    pressure = df[pressure_col]&#10;&#10;    # Calculate time derivative (hPa per hour)&#10;    dt_hours = df.index.to_series().diff().dt.total_seconds() / 3600  # Convert to hours&#10;    dp = pressure.diff()&#10;    dp_dt = dp / dt_hours&#10;&#10;    # Optional: apply rolling mean for smoothing&#10;    # dp_dt_smooth = dp_dt.rolling(window=window, center=True).mean()&#10;&#10;    return dp_dt, pressure&#10;&#10;&#10;def plot_pressure_tendency(stations_data, save_path=None):&#10;    &quot;&quot;&quot;&#10;    Plot pressure and pressure tendency for all stations.&#10;&#10;    Parameters&#10;    ----------&#10;    stations_data : dict&#10;        Dictionary with station names as keys and (pressure_tendency, pressure) tuples as values&#10;    save_path : str, optional&#10;        Path to save the figure&#10;    &quot;&quot;&quot;&#10;    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 10), sharex=True)&#10;&#10;    colors = {'Kufstein': 'blue', 'Jenbach': 'green', 'Innsbruck Uni': 'red'}&#10;&#10;    # Plot pressure&#10;    for station_name, (dp_dt, pressure) in stations_data.items():&#10;        ax1.plot(pressure.index, pressure.values, label=station_name,&#10;                color=colors.get(station_name, 'black'), linewidth=2)&#10;&#10;    ax1.set_ylabel('Pressure [hPa]', fontsize=12)&#10;    ax1.set_title('Surface Pressure along the Inn Valley', fontsize=14, fontweight='bold')&#10;    ax1.legend(loc='best')&#10;    ax1.grid(True, alpha=0.3)&#10;&#10;    # Plot pressure tendency&#10;    for station_name, (dp_dt, pressure) in stations_data.items():&#10;        ax2.plot(dp_dt.index, dp_dt.values, label=station_name,&#10;                color=colors.get(station_name, 'black'), linewidth=2)&#10;&#10;    ax2.set_ylabel('Pressure Tendency [hPa/h]', fontsize=12)&#10;    ax2.set_xlabel('Time', fontsize=12)&#10;    ax2.set_title('Pressure Tendency (dP/dt) along the Inn Valley', fontsize=14, fontweight='bold')&#10;    ax2.legend(loc='best')&#10;    ax2.grid(True, alpha=0.3)&#10;    ax2.axhline(y=0, color='black', linestyle='--', alpha=0.5)&#10;&#10;    plt.tight_layout()&#10;&#10;    if save_path:&#10;        plt.savefig(save_path, dpi=300, bbox_inches='tight')&#10;        print(f&quot;Figure saved to: {save_path}&quot;)&#10;&#10;    plt.show()&#10;&#10;    return fig&#10;&#10;&#10;&#10;&#10;if __name__ == &quot;__main__&quot;:&#10;    &quot;&quot;&quot;&#10;    Main function to calculate and plot pressure tendency along Inn valley.&#10;    &quot;&quot;&quot;&#10;    print(&quot;Reading ZAMG station data...&quot;)&#10;&#10;    # Define stations with their file paths and names&#10;    stations = {&#10;        'Kufstein': confg.kufstein_zamg,&#10;        'Jenbach': confg.jenbach_zamg,&#10;        'Innsbruck Uni': confg.innsbruck_uni_zamg&#10;    }&#10;&#10;    # Dictionary to store results&#10;    stations_data = {}&#10;&#10;    # Read and process each station&#10;    for station_name, filepath in stations.items():&#10;        print(f&quot;\nProcessing {station_name}...&quot;)&#10;        try:&#10;            # Read CSV file with comma separator&#10;            df = pd.read_csv(filepath, sep=',', parse_dates=['time'], index_col='time')&#10;            print(f&quot;  Columns available: {df.columns.tolist()}&quot;)&#10;&#10;            # Subset to specific time range&#10;            df_subset = df.loc['2017-10-15 12:00:00':'2017-10-16 12:00:00']&#10;            # Select only rows at 00 and 30 minute marks (no averaging)&#10;            df_30min = df_subset[df_subset.index.to_series().dt.minute.isin([0, 30])]&#10;            print(f&quot;  Data points at 30min intervals: {len(df_30min)}&quot;)&#10;&#10;            # Calculate pressure tendency&#10;            dp_dt, pressure = calculate_pressure_tendency(df_30min)&#10;            stations_data[station_name] = (dp_dt, pressure)&#10;&#10;            # Print some statistics&#10;            print(f&quot;  Time range: {df.index[0]} to {df.index[-1]}&quot;)&#10;            print(f&quot;  Mean pressure: {pressure.mean():.2f} hPa&quot;)&#10;            print(f&quot;  Mean pressure tendency: {dp_dt.mean():.4f} hPa/h&quot;)&#10;            if not dp_dt.dropna().empty:&#10;                print(f&quot;  Max pressure tendency: {dp_dt.dropna().max():.4f} hPa/h&quot;)&#10;                print(f&quot;  Min pressure tendency: {dp_dt.dropna().min():.4f} hPa/h&quot;)&#10;&#10;        except Exception as e:&#10;            print(f&quot;  Error processing {station_name}: {str(e)}&quot;)&#10;            continue&#10;&#10;    # Plot results&#10;    if stations_data:&#10;        print(&quot;\nCreating plots...&quot;)&#10;        save_path = confg.dir_PLOTS + &quot;/Inn_valley_pressure_tendency.png&quot;&#10;        plot_pressure_tendency(stations_data, save_path=save_path)&#10;    else:&#10;        print(&quot;No data to plot!&quot;)&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/confg.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/confg.py" />
              <option name="originalContent" value="&quot;&quot;&quot;In this &quot;confg-script&quot; are all the data filepaths listed&#10;You have to change it!&#10;original by hannes, daniel adapted it a bit and added/edited some coords and definitions that are multiple times used&#10;to avoid double definitions &amp; confusions...&#10;&#10;&quot;&quot;&quot;&#10;&#10;import os&#10;&#10;# -------------------------------------------To change --------------------------------------------------------&#10;# Folder where the model output is saved:&#10;model_folder = os.path.normpath(&quot;D:/MSc_Arbeit&quot;)&#10;# Folder where the data is saved:&#10;data_folder = os.path.join(model_folder, &quot;data&quot;)&#10;# Plot directory (where to save the plots)&#10;dir_PLOTS = os.path.join(model_folder, &quot;plots&quot;)&#10;dir_topo_plots = os.path.join(dir_PLOTS, &quot;topography_comparison&quot;)&#10;&#10;# -------------------------------------------constants needed for calculations---------------------------------&#10;hafelekar_height = 2279  # m, highest HOBO from https://zenodo.org/records/4672313 hobo dataset, used for VHD calc&#10;c_p = 1005  # J/(kg*K), specific heat capacity of air at constant pressure, for VHD calc&#10;&#10;# All point locations defined below (created for Daniel's thesis):&#10;ALL_POINTS = {&quot;ibk_villa&quot;: {&quot;name&quot;: &quot;ibk villa&quot;, &quot;lat&quot;: 47.25971, &quot;lon&quot;: 11.38420, &quot;height&quot;: 579},&#10;              # same lat &amp; lon of Ibk cosma already used: which&#10;              # is for Ibk_Villa (2m temp recording); changed point to coords of https://acinn-data.uibk.ac.at/pages/meteodat.html&#10;              # now 4 m higher as Cosma's point (she had 575m ...)&#10;&#10;              &quot;ibk_uni&quot;: {&quot;name&quot;: &quot;ibk uni&quot;, &quot;lat&quot;: 47.264, &quot;lon&quot;: 11.385, &quot;height&quot;: 612},&#10;              # hatpro, uni coords rounded to 3 digits after comma&#10;              &quot;ibk_airport&quot;: {&quot;name&quot;: &quot;ibk airport&quot;, &quot;lat&quot;: 47.26, &quot;lon&quot;: 11.34, &quot;height&quot;: 577},&#10;              &quot;hafelekar&quot;: {&quot;name&quot;: &quot;hafelekar&quot;, &quot;lat&quot;: 47.312, &quot;lon&quot;: 11.383, &quot;height&quot;: hafelekar_height},&#10;              # 2279m, with 3 digits&#10;              &quot;slope_north_patscherkofel&quot;: {&quot;name&quot;: &quot;slope north patscherkofel&quot;, &quot;lat&quot;: 47.23, &quot;lon&quot;: 11.5,&#10;                                            &quot;height&quot;: 1750},&#10;              &quot;woergl&quot;: {&quot;name&quot;: &quot;woergl&quot;, &quot;lat&quot;: 47.494, &quot;lon&quot;: 12.059, &quot;height&quot;: 504},&#10;              # coords for wörgl (504m), lower Inn valley&#10;              &quot;kiefersfelden&quot;: {&quot;name&quot;: &quot;kiefersfelden&quot;, &quot;lat&quot;: 47.62, &quot;lon&quot;: 12.2, &quot;height&quot;: 480},&#10;              # coords for kiefersfelden (480m), Germany, entrance Inn valley&#10;              &quot;telfs&quot;: {&quot;name&quot;: &quot;telfs&quot;, &quot;lat&quot;: 47.3, &quot;lon&quot;: 11.1, &quot;height&quot;: 622},  # 622m&#10;              # valley points in wipp &amp; ziller valley for stability plots (where valleys are narrow):&#10;              &quot;wipp_valley&quot;: {&quot;name&quot;: &quot;wipp valley&quot;, &quot;lat&quot;: 47.13, &quot;lon&quot;: 11.45, &quot;height&quot;: 1044},&#10;              # between Schönberg &amp; Matrei&#10;              &quot;ziller_valley&quot;: {&quot;name&quot;: &quot;ziller valley&quot;, &quot;lat&quot;: 47.25, &quot;lon&quot;: 11.9, &quot;height&quot;: 565},&#10;              # between Zell am Ziller &amp; Zillertal&#10;              &quot;ziller_ried&quot;: {&quot;name&quot;: &quot;ziller ried&quot;, &quot;lat&quot;: 47.3, &quot;lon&quot;: 11.87, &quot;height&quot;: 572}  # Zillertal, Kaltenbach&#10;              }&#10;POINT_NAMES = list(ALL_POINTS.keys())  # list w. all point names&#10;# coordinates of points used for Daniels' Analysis; all points that should include HATPRO or Radiosonde data in&#10;# the point plots need &quot;ibk&quot; in the beginning of point definition&#10;# heights in m from https://www.freemaptools.com/elevation-finder.htm&#10;&#10;# List of point keys for easy iteration - coordinates of points used for Daniels' Analysis&#10;# Points that should include HATPRO plot (VHD) need &quot;ibk&quot; in name&#10;# Heights in m from https://www.freemaptools.com/elevation-finder.htm&#10;&#10;# Define point categories for easy filtering; hardcoded list to distinguish valley and mountain points&#10;VALLEY_POINTS = [&quot;ibk_villa&quot;, &quot;ibk_uni&quot;, &quot;ibk_airport&quot;, &quot;woergl&quot;, &quot;kiefersfelden&quot;, &quot;telfs&quot;, &quot;wipp_valley&quot;,&#10;                 &quot;ziller_valley&quot;, &quot;ziller_ried&quot;]&#10;MOUNTAIN_SLOPE_POINTS = [&quot;hafelkar&quot;, &quot;slope_north_patscherkofel&quot;]&#10;&#10;&#10;def get_valley_points_only():&#10;    &quot;&quot;&quot;Get only valley points (excludes mountains and slopes)&quot;&quot;&quot;&#10;    return {key: value for key, value in ALL_POINTS.items() if key in VALLEY_POINTS}&#10;&#10;&#10;def get_points_excluding_mountains():&#10;    &quot;&quot;&quot;Get all points except mountain/slope points&quot;&quot;&quot;&#10;    return {key: value for key, value in ALL_POINTS.items() if key not in MOUNTAIN_SLOPE_POINTS}&#10;&#10;&#10;lat_hf_min, lat_hf_max = 47, 47.6&#10;lon_hf_min, lon_hf_max = 11.1, 12.1&#10;&#10;lat_min_vhd, lat_max_vhd = 47, 47.7  # orig: 47, 47.7    # lat &amp; lon values for vhd domain plotting&#10;lon_min_vhd, lon_max_vhd = 10.8, 12  # 10.8, 12&#10;&#10;lat_min_cap_height, lat_max_cap_height = 47, 48.2&#10;lon_min_cap_height, lon_max_cap_height = 10.6, 13&#10;&#10;lat_min, lat_max = 46.5, 48.2&#10;lon_min, lon_max = 9.2, 13&#10;&#10;# -------------------------------------------------------------------------------------------------------------&#10;radiosonde_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;Radiosonde&quot;)&#10;radiosonde_csv = os.path.join(radiosonde_folder,&#10;                              &quot;2017101603_bufr309052.csv&quot;)  # radiosonden aufstieg at innsbruck airport&#10;# deprecated: radiosonde_edited = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_2017101603.csv&quot;)  # calculated pot. temp &amp; rho&#10;# from other vars&#10;radiosonde_dataset = os.path.join(radiosonde_folder,&#10;                                  &quot;radiosonde_ibk_2017101603.nc&quot;)  # for same handling for plots &amp; calcs  save&#10;# Radiosonde as dataset&#10;# radiosonde_dataset_height_as_z = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_2017101603_height_as_z.nc&quot;)  # deprecated,&#10;# use fct in réad_in_hatpro_radiosonde.py&#10;# only geopot. height instead of &quot;height values&quot;&#10;# deprecated? radiosonde_smoothed = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_smoothed.nc&quot;)&#10;&#10;all_model_topographies = os.path.join(model_folder, &quot;AROME&quot;,&#10;                                      &quot;all_model_topographies.nc&quot;)  # all topography-values extracted (lowest&#10;# lvl) of geopot. height + &quot;hgt&quot; - vars for AROME &amp; WRF and put into one file&#10;&#10;JSON_TIROL = os.path.join(data_folder, &quot;Height&quot;, &quot;gadm41_AUT_1.json&quot;)  # tirol json file&#10;DEMFILE_CLIP = os.path.join(data_folder, &quot;Height&quot;, &quot;dem_clipped.tif&quot;)  # dem file (höhe)&#10;TIROL_DEMFILE = os.path.join(data_folder, &quot;Height&quot;, &quot;dem.tif&quot;)  # changed dem file: indexed and renamed coords&#10;dem_smoothed = os.path.join(data_folder, &quot;Height&quot;, &quot;dem_smoothed.tif&quot;)&#10;filepath_arome_height = os.path.join(model_folder, &quot;AROME&quot;, &quot;AROME_TEAMx_CAP_3D_fields&quot;,&#10;                                     &quot;AROME_Geosphere_20171015T1200Z_CAP02_3D_30min_1km_best_z.nc&quot;)&#10;dem_file_hobos_extent = os.path.join(data_folder, &quot;Height&quot;,&#10;                                     &quot;dem_cut_hobos.tif&quot;)  # created DEM (in model_topography) to see real&#10;# heights with HOBOS&#10;&#10;# ZAMG Datahub files&#10;kufstein_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                             &quot;data_station9016-Kufstein_20171012_20171018.csv&quot;)&#10;kufstein_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_station9016_Kufstein_new.csv&quot;)&#10;&#10;innsbruck_uni_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                  &quot;data_station11803-InnsbruckUniversity_20171012_20171018.csv&quot;)&#10;innsbruck_uni_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                      &quot;data_station11803-InnsbruckUniversity_new.csv&quot;)&#10;innsbruck_airport_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                      &quot;data_station11804-InnsbruckAirport_20171012_20171018.csv&quot;)&#10;innsbruck_airport_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                          &quot;data_station11804-InnsbruckAirport_new.csv&quot;)&#10;&#10;jenbach_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                            &quot;data_station11901-Jenbach_20171012_20171018.csv&quot;)&#10;jenbach_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_station11901-Jenbach_new.csv&quot;)&#10;&#10;rinn_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                         &quot;data_station11123-Rinn_20171015T1200_20171016T1210.csv&quot;)&#10;munchen_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_munich_T2m.csv&quot;)&#10;&#10;# mobile stations, cut to our period&#10;momma_our_period_file = os.path.join(data_folder, &quot;Observations&quot;, &quot;MOMMA&quot;, &quot;MOMMA_our_period.nc&quot;)&#10;&#10;# ----------------------------------Models-----------------------------------------------------&#10;&#10;# absolute paths AROME&#10;dir_AROME = os.path.join(model_folder, &quot;AROME&quot;)&#10;dir_2D_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_2D_fields&quot;)&#10;dir_3D_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_3D_fields&quot;)&#10;dir_timeseries_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_timeseries&quot;)&#10;&#10;# absolute paths WRF&#10;wrf_folder = os.path.join(model_folder, &quot;WRF_ACINN&quot;)  # before: wrf_ACINN&#10;&#10;# absolute paths ICON&#10;icon_folder_3D = os.path.join(model_folder, &quot;ICON&quot;)&#10;icon_folder_meteogram = os.path.join(model_folder, &quot;icon&quot;, &quot;ICON_Meteogram&quot;)  # ?&#10;&#10;# absolute paths ICON2TE&#10;icon2TE_folder_3D = os.path.join(model_folder, &quot;ICON2TE&quot;)&#10;&#10;# absolute Path UKMO&#10;ukmo_folder = os.path.join(model_folder, &quot;ukmo&quot;)&#10;&#10;# ------------------------------colormaps for plotting ---------------------------------------------&#10;from colorspace import qualitative_hcl&#10;&#10;# --- Color scheme for models (consistent with plot_cap_height) ---&#10;qualitative_colors_temp = qualitative_hcl(palette=&quot;Dark 3&quot;).colors()&#10;qualitative_colors_wind = qualitative_colors_temp&#10;qualitative_colors_humidity = qualitative_hcl(palette=&quot;Dark 3&quot;).colors()&#10;&#10;# Model color mapping for temperature - ICON and ICON2TE share the same color; take same color for LIDAR88 and HATPRO&#10;model_colors_temp_wind = {&quot;AROME&quot;: qualitative_colors_temp[0], &quot;ICON&quot;: qualitative_colors_temp[2],&#10;                          &quot;ICON2TE&quot;: qualitative_colors_temp[2], &quot;UM&quot;: qualitative_colors_temp[4],&#10;                          &quot;WRF&quot;: qualitative_colors_temp[6], &quot;Radiosonde&quot;: qualitative_colors_temp[10],&#10;                          &quot;HATPRO&quot;: qualitative_colors_temp[8], &quot;LIDAR88&quot;: qualitative_colors_temp[8],&#10;                          &quot;LIDAR142&quot;: qualitative_colors_temp[9]}&#10;&#10;# Model color mapping for humidity&#10;model_colors_humidity = {&quot;AROME&quot;: qualitative_colors_humidity[0], &quot;ICON&quot;: qualitative_colors_humidity[2],&#10;                         &quot;ICON2TE&quot;: qualitative_colors_humidity[2], &quot;UM&quot;: qualitative_colors_humidity[4],&#10;                         &quot;WRF&quot;: qualitative_colors_humidity[6], &quot;Radiosonde&quot;: qualitative_colors_humidity[10],&#10;                         &quot;HATPRO&quot;: qualitative_colors_humidity[8]}&#10;&#10;# define linestyle for ICON2TE&#10;icon_2te_hatpro_linestyle = &quot;dot&quot;&#10;&#10;# -------------------------------Data and Plot paths -----------------------------------------------&#10;&#10;# EC stations&#10;dir_EC_stations = f&quot;{data_folder}/Observations/EC_4_stations&quot;&#10;EC_30min_final = f&quot;{dir_EC_stations}/EC_30min_file.nc&quot;&#10;EC_1min_final = f&quot;{dir_EC_stations}/EC_1min_file.nc&quot;&#10;&#10;# Ibox dir&#10;ibox_folder = f&quot;{data_folder}/Observations/Ibox&quot;&#10;&#10;# HOBOS station&#10;hobos_file = f&quot;{data_folder}/Observations/HOBOS/hobos_final.nc&quot;  # Observations/HOBOS/&#10;&#10;# Lidar obs&#10;lidar_obs_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;LIDAR&quot;)&#10;lidar_sl88 = os.path.join(lidar_obs_folder, &quot;SL88_vad_l2&quot;)  # add trailing separator for consistency&#10;lidar_slxr142 = os.path.join(lidar_obs_folder, &quot;SLXR142_vad_l2&quot;)&#10;# merged files, subsetted to period and 30 min intervals are saved in:&#10;lidar_sl88_merged_path = os.path.join(lidar_sl88, 'sl88_merged.nc')&#10;lidar_slxr142_merged_path = os.path.join(lidar_slxr142, 'slxr142_merged.nc')&#10;&#10;# HATPRO obs&#10;hatpro_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;HATPRO_obs&quot;)  # nicht vorhanden?&#10;hatpro_merged = os.path.join(hatpro_folder, &quot;hatpro_merged.nc&quot;)  # + &quot;hatpro_merged.nc&quot;&#10;hatpro_smoothed = os.path.join(hatpro_folder, &quot;hatpro_smoothed.nc&quot;)&#10;hatpro_calced_vars = os.path.join(hatpro_folder, &quot;hatpro_calced_vars_from_arome_p_height_as_z.nc&quot;)&#10;hatpro_with_cap_height = os.path.join(hatpro_folder, &quot;hatpro_interpolated_arome_height_as_z_with_cap_height.nc&quot;)&#10;&#10;# Radiosonde CAP height is 1537 m (searched by hand) - ibk_airport[&quot;height&quot;] = 960 m&#10;radiosonde_cap_height = 1537 - ALL_POINTS[&quot;ibk_airport&quot;][&quot;height&quot;]&#10;# deprecated ones?&#10;# hatpro_interp_arome = hatpro_folder + &quot;hatpro_interpolated_arome.nc&quot;&#10;# hatpro_interp_arome_height_as_z = hatpro_folder + &quot;hatpro_interpolated_arome_height_as_z.nc&quot;&#10;&#10;&#10;# Define colors for the models to use the same in each plot:&#10;colordict = {&quot;HOBOS&quot;: &quot;purple&quot;, &quot;ICON&quot;: &quot;orange&quot;, &quot;RADIOSONDE&quot;: &quot;black&quot;, &quot;AROME&quot;: &quot;red&quot;, &quot;HATPRO&quot;: &quot;gray&quot;,&#10;             &quot;UKMO&quot;: &quot;green&quot;, &quot;WRF_ACINN&quot;: &quot;blue&quot;}&#10;&#10;# Create a dictionary with information of the TAWES stations&#10;station_files_zamg = {&#10;    &quot;IAO&quot;: {&quot;filepath&quot;: innsbruck_uni_zamg, &quot;name&quot;: &quot;Innsbruck Uni&quot;, 'lon': 11.384167, 'lat': 47.259998,&#10;            'hoehe': 578, },&#10;    &quot;JEN&quot;: {&quot;filepath&quot;: jenbach_zamg, &quot;name&quot;: &quot;Jenbach&quot;, 'lat': 47.388889, 'lon': 11.758056, 'hoehe': 530, },&#10;    &quot;KUF&quot;: {&quot;filepath&quot;: kufstein_zamg, &quot;name&quot;: &quot;Kufstein&quot;, 'lon': 12.162778, 'lat': 47.575279, 'hoehe': 490, },&#10;    &quot;LOWI&quot;: {&quot;filepath&quot;: innsbruck_airport_zamg, &quot;name&quot;: &quot;Innsbruck Airport&quot;, 'lat': 47.2598, 'lon': 11.3553,&#10;             'hoehe': 578, }, &quot;IMST&quot;: {  # &quot;filepath&quot;: imst_zamg,&#10;        &quot;name&quot;: &quot;Imst&quot;, 'lat': 47.2419, 'lon': 10.7218, 'hoehe': 828, }}&#10;&#10;# created a NEW dic with new zamg files:&#10;station_files_zamg_new = {&#10;    &quot;IAO&quot;: {&quot;filepath&quot;: innsbruck_uni_zamg_new, &quot;name&quot;: &quot;Innsbruck Uni&quot;, 'lon': 11.384167, 'lat': 47.259998,&#10;            'hoehe': ALL_POINTS[&quot;ibk_uni&quot;][&quot;height&quot;], },  # set to 612m, Uni roof!&#10;    &quot;JEN&quot;: {&quot;filepath&quot;: jenbach_zamg_new, &quot;name&quot;: &quot;Jenbach&quot;, 'lat': 47.388889, 'lon': 11.758056, 'hoehe': 530, },&#10;    &quot;KUF&quot;: {&quot;filepath&quot;: kufstein_zamg_new, &quot;name&quot;: &quot;Kufstein&quot;, 'lon': 12.162778, 'lat': 47.575279, 'hoehe': 490, },&#10;    &quot;LOWI&quot;: {&quot;filepath&quot;: innsbruck_airport_zamg_new, &quot;name&quot;: &quot;Innsbruck Airport&quot;, 'lat': 47.2598, 'lon': 11.3553,&#10;             'hoehe': 578, }, &quot;IMST&quot;: {  # &quot;filepath&quot;: imst_zamg,&#10;        &quot;name&quot;: &quot;Imst&quot;, 'lat': 47.2419, 'lon': 10.7218, 'hoehe': 828, }}&#10;&#10;# create a dict with info about the IBOX stations&#10;stations_ibox = {&#10;    &quot;VF0&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/vf0.csv&quot;, &quot;name&quot;: &quot;Kolsass&quot;, &quot;latitude&quot;: 47.305, &quot;longitude&quot;: 11.622,&#10;            &quot;height&quot;: 545},&#10;    &quot;SF8&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/sf8.csv&quot;, &quot;name&quot;: &quot;Terfens&quot;, &quot;latitude&quot;: 47.326, &quot;longitude&quot;: 11.652,&#10;            &quot;height&quot;: 575},&#10;    &quot;SF1&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/sf1.csv&quot;, &quot;name&quot;: &quot;Eggen&quot;, &quot;latitude&quot;: 47.317, &quot;longitude&quot;: 11.616,&#10;            &quot;height&quot;: 829},&#10;    &quot;NF10&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/nf10.csv&quot;, &quot;name&quot;: &quot;Weerberg&quot;, &quot;latitude&quot;: 47.300, &quot;longitude&quot;: 11.673,&#10;             &quot;height&quot;: 930},&#10;    &quot;NF27&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/nf27.csv&quot;, &quot;name&quot;: &quot;Hochhaeuser&quot;, &quot;latitude&quot;: 47.288, &quot;longitude&quot;: 11.631,&#10;             &quot;height&quot;: 1009}}&#10;&#10;# dict with infos about EC stations&#10;ec_station_names = {1: {&quot;name&quot;: &quot;Patsch_EC_South&quot;, &quot;lat&quot;: 47.209068, &quot;lon&quot;: 11.411932},&#10;                    0: {&quot;name&quot;: &quot;Innsbruck_Airport_EC_West&quot;, &quot;lat&quot;: 47.255375, &quot;lon&quot;: 11.342832},&#10;                    2: {&quot;name&quot;: &quot;Thaur_EC_East&quot;, &quot;lat&quot;: 47.281335, &quot;lon&quot;: 11.474532},&#10;                    3: {&quot;name&quot;: &quot;IAO_Centre_Innsbruck_EC_Center&quot;, &quot;lat&quot;: 47.264035, &quot;lon&quot;: 11.385707}}&#10;&#10;# variables, units 2D AROME&#10;variables_units_2D_AROME = {'hfs': 'W/m²',  # Sensible heat flux at the surface&#10;                            'hgt': 'm',  # Surface geopotential height&#10;                            'lfs': 'W/m²',  # Latent heat flux at the surface&#10;                            'lwd': 'W/m²',  # Longwave incoming radiation at the surface&#10;                            'lwnet': 'W/m²',  # Longwave net radiation at the surface&#10;                            'lwu': 'W/m²',  # Longwave outgoing radiation at the surface (derived: lwnet - lwd)&#10;                            'pre': 'kg/m²',  # Surface precipitation (same as mm)&#10;                            'ps': 'Pa',  # Surface pressure&#10;                            'swd': 'W/m²',  # Shortwave incoming radiation at the surface&#10;                            'swnet': 'W/m²',  # Shortwave net radiation at the surface&#10;                            'swu': 'W/m²',  # Shortwave reflected radiation at the surface (derived: swnet - swd)&#10;                            'tsk': 'K'  # Surface temperature (Oberflächentemperatur)&#10;                            }&#10;&#10;# variables, units 3D AROME&#10;variables_units_3D_AROME = {'ciwc': 'kg/kg',  # Specific cloud ice water content&#10;                            'clwc': 'kg/kg',  # Specific cloud liquid water content&#10;                            'p': 'Pa',  # Pressure&#10;                            'q': 'kg/kg',  # Specific humidity&#10;                            'th': 'K',  # Potential temperature&#10;                            'tke': 'm²/s²',  # Turbulent kinetic energy&#10;                            'u': 'm/s',  # Zonal wind component&#10;                            'v': 'm/s',  # Meridional wind component&#10;                            'w': 'm/s',  # Vertical wind velocity&#10;                            'z': 'm',  # Geopotential height&#10;                            }&#10;&#10;# Define colors for the cities, used e.g. in temperature timeseries&#10;cities = {&#10;    'Innsbruck Uni': {'lon': 11.384167, 'lat': 47.259998, 'csv': innsbruck_uni_zamg, 'color': &quot;red&quot;, 'hoehe': 578, },&#10;    'Kufstein': {'lon': 12.162778, 'lat': 47.575279, 'csv': kufstein_zamg, 'color': &quot;blue&quot;, 'hoehe': 490, },&#10;    'Innsbruck Airport': {'lat': 47.2598, 'lon': 11.3553, 'csv': innsbruck_airport_zamg, 'color': &quot;green&quot;,&#10;                          'hoehe': 578, },&#10;    'Jenbach': {'lat': 47.388889, 'lon': 11.758056, 'csv': jenbach_zamg, 'color': &quot;gray&quot;, 'hoehe': 530, },&#10;    'Rinn': {'lat': 47.249168, 'lon': 11.503889, 'csv': rinn_zamg, 'color': &quot;purple&quot;, 'hoehe': 924},&#10;    'Muenchen': {'lat': 48.149723, 'lon': 11.540523, 'color': &quot;orange&quot;, 'hoehe': 521, 'csv': munchen_zamg&#10;                 # Replace 'munchen_zamg' with the actual path to your CSV file if you have data for München&#10;                 }}&#10;&#10;# information about MOMMA stations&#10;MOMMA_stations = {&quot;0&quot;: &quot;Völs&quot;, &quot;1&quot;: &quot;Innsbruck_Bergisel&quot;, &quot;2&quot;: &quot;Patsch_Pfaffenbichl&quot;, &quot;3&quot;: &quot;Innsbruck_Ölberg&quot;,&#10;                  &quot;4&quot;: &quot;Innsbruck_Hotel Hilton&quot;, &quot;5&quot;: &quot;Innsbruck_Saggen_Kettenbrücke&quot;, &quot;6&quot;: &quot;Volders&quot;,&#10;                  &quot;7&quot;: &quot;Unterperfuss&quot;, &quot;8&quot;: &quot;Inzing_Zirl_Modellflugplatz&quot;}&#10;&#10;MOMMA_stations_PM = {&#10;    &quot;PM02&quot;: {&quot;name&quot;: &quot;Völs&quot;, &quot;latitude&quot;: 47.2614791608, &quot;longitude&quot;: 11.3117537274, &quot;height&quot;: 583, &quot;key&quot;: 0},&#10;    &quot;PM03&quot;: {&quot;name&quot;: &quot;Innsbruck_Bergisel&quot;, &quot;latitude&quot;: 47.2472604421, &quot;longitude&quot;: 11.3986000093, &quot;height&quot;: 726,&#10;             &quot;key&quot;: 1},&#10;    &quot;PM04&quot;: {&quot;name&quot;: &quot;Patsch_Pfaffenbichl&quot;, &quot;latitude&quot;: 47.21030188, &quot;longitude&quot;: 11.4105114057, &quot;height&quot;: 983,&#10;             &quot;key&quot;: 2},&#10;    &quot;PM05&quot;: {&quot;name&quot;: &quot;Innsbruck_Ölberg&quot;, &quot;latitude&quot;: 47.2784241867, &quot;longitude&quot;: 11.3902967638, &quot;height&quot;: 722,&#10;             &quot;key&quot;: 3},&#10;    &quot;PM06&quot;: {&quot;name&quot;: &quot;Innsbruck_Hotel Hilton&quot;, &quot;latitude&quot;: 47.2620425014, &quot;longitude&quot;: 11.3959606669, &quot;height&quot;: 629,&#10;             &quot;key&quot;: 4},&#10;    &quot;PM07&quot;: {&quot;name&quot;: &quot;Innsbruck_Saggen_Kettenbrücke&quot;, &quot;latitude&quot;: 47.2787431973, &quot;longitude&quot;: 11.4123320657,&#10;             &quot;height&quot;: 569, &quot;key&quot;: 5},&#10;    &quot;PM08&quot;: {&quot;name&quot;: &quot;Volders&quot;, &quot;latitude&quot;: 47.2930516284, &quot;longitude&quot;: 11.5697988436, &quot;height&quot;: 552, &quot;key&quot;: 6},&#10;    &quot;PM09&quot;: {&quot;name&quot;: &quot;Unterperfuss&quot;, &quot;latitude&quot;: 47.2615210341, &quot;longitude&quot;: 11.2607050096, &quot;height&quot;: 594, &quot;key&quot;: 7},&#10;    &quot;PM10&quot;: {&quot;name&quot;: &quot;Inzing_Zirl_Modellflugplatz&quot;, &quot;latitude&quot;: 47.2744017492, &quot;longitude&quot;: 11.2143291427,&#10;             &quot;height&quot;: 597, &quot;key&quot;: 8}}&#10;&#10;# units of lidar observations&#10;vars_lidar = {'u': 'm/s', 'v': 'm/s', 'w': 'm/s', 'ff': 'm/s', 'dd': 'degree'}&#10;&#10;# hatpro height information&#10;hatpro_vertical_levels = {&#10;    &quot;height_name&quot;: [&quot;V01&quot;, &quot;V02&quot;, &quot;V03&quot;, &quot;V04&quot;, &quot;V05&quot;, &quot;V06&quot;, &quot;V07&quot;, &quot;V08&quot;, &quot;V09&quot;, &quot;V10&quot;, &quot;V11&quot;, &quot;V12&quot;, &quot;V13&quot;, &quot;V14&quot;,&#10;                    &quot;V15&quot;, &quot;V16&quot;, &quot;V17&quot;, &quot;V18&quot;, &quot;V19&quot;, &quot;V20&quot;, &quot;V21&quot;, &quot;V22&quot;, &quot;V23&quot;, &quot;V24&quot;, &quot;V25&quot;, &quot;V26&quot;, &quot;V27&quot;, &quot;V28&quot;,&#10;                    &quot;V29&quot;, &quot;V30&quot;, &quot;V31&quot;, &quot;V32&quot;, &quot;V33&quot;, &quot;V34&quot;, &quot;V35&quot;, &quot;V36&quot;, &quot;V37&quot;, &quot;V38&quot;, &quot;V39&quot;],&#10;    &quot;height&quot;: [&quot;0&quot;, &quot;10&quot;, &quot;30&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;, &quot;125&quot;, &quot;150&quot;, &quot;200&quot;, &quot;250&quot;, &quot;325&quot;, &quot;400&quot;, &quot;475&quot;, &quot;550&quot;, &quot;625&quot;, &quot;700&quot;,&#10;               &quot;800&quot;, &quot;900&quot;, &quot;1000&quot;, &quot;1150&quot;, &quot;1300&quot;, &quot;1450&quot;, &quot;1600&quot;, &quot;1800&quot;, &quot;2000&quot;, &quot;2200&quot;, &quot;2500&quot;, &quot;2800&quot;, &quot;3100&quot;,&#10;               &quot;3500&quot;, &quot;3900&quot;, &quot;4400&quot;, &quot;5000&quot;, &quot;5600&quot;, &quot;6200&quot;, &quot;7000&quot;, &quot;8000&quot;, &quot;9000&quot;, &quot;10000&quot;]}" />
              <option name="updatedContent" value="&quot;&quot;&quot;In this &quot;confg-script&quot; are all the data filepaths listed&#10;You have to change it!&#10;original by hannes, daniel adapted it a bit and added/edited some coords and definitions that are multiple times used&#10;to avoid double definitions &amp; confusions...&#10;&#10;&quot;&quot;&quot;&#10;&#10;import os&#10;&#10;# -------------------------------------------To change --------------------------------------------------------&#10;# Folder where the model output is saved:&#10;model_folder = os.path.normpath(&quot;D:/MSc_Arbeit&quot;)&#10;# Folder where the data is saved:&#10;data_folder = os.path.join(model_folder, &quot;data&quot;)&#10;# Plot directory (where to save the plots)&#10;dir_PLOTS = os.path.join(model_folder, &quot;plots&quot;)&#10;dir_topo_plots = os.path.join(dir_PLOTS, &quot;topography_comparison&quot;)&#10;&#10;# -------------------------------------------constants needed for calculations---------------------------------&#10;hafelekar_height = 2279  # m, highest HOBO from https://zenodo.org/records/4672313 hobo dataset, used for VHD calc&#10;c_p = 1005  # J/(kg*K), specific heat capacity of air at constant pressure, for VHD calc&#10;&#10;# All point locations defined below (created for Daniel's thesis):&#10;ALL_POINTS = {&quot;ibk_villa&quot;: {&quot;name&quot;: &quot;ibk villa&quot;, &quot;lat&quot;: 47.25971, &quot;lon&quot;: 11.38420, &quot;height&quot;: 579},&#10;              # same lat &amp; lon of Ibk cosma already used: which&#10;              # is for Ibk_Villa (2m temp recording); changed point to coords of https://acinn-data.uibk.ac.at/pages/meteodat.html&#10;              # now 4 m higher as Cosma's point (she had 575m ...)&#10;&#10;              &quot;ibk_uni&quot;: {&quot;name&quot;: &quot;ibk uni&quot;, &quot;lat&quot;: 47.264, &quot;lon&quot;: 11.385, &quot;height&quot;: 612},&#10;              # hatpro, uni coords rounded to 3 digits after comma&#10;              &quot;ibk_airport&quot;: {&quot;name&quot;: &quot;ibk airport&quot;, &quot;lat&quot;: 47.26, &quot;lon&quot;: 11.34, &quot;height&quot;: 577},&#10;              &quot;hafelekar&quot;: {&quot;name&quot;: &quot;hafelekar&quot;, &quot;lat&quot;: 47.312, &quot;lon&quot;: 11.383, &quot;height&quot;: hafelekar_height},&#10;              # 2279m, with 3 digits&#10;              &quot;slope_north_patscherkofel&quot;: {&quot;name&quot;: &quot;slope north patscherkofel&quot;, &quot;lat&quot;: 47.23, &quot;lon&quot;: 11.5,&#10;                                            &quot;height&quot;: 1750},&#10;              &quot;woergl&quot;: {&quot;name&quot;: &quot;woergl&quot;, &quot;lat&quot;: 47.494, &quot;lon&quot;: 12.059, &quot;height&quot;: 504},&#10;              # coords for wörgl (504m), lower Inn valley&#10;              &quot;kiefersfelden&quot;: {&quot;name&quot;: &quot;kiefersfelden&quot;, &quot;lat&quot;: 47.62, &quot;lon&quot;: 12.2, &quot;height&quot;: 480},&#10;              # coords for kiefersfelden (480m), Germany, entrance Inn valley&#10;              &quot;telfs&quot;: {&quot;name&quot;: &quot;telfs&quot;, &quot;lat&quot;: 47.3, &quot;lon&quot;: 11.1, &quot;height&quot;: 622},  # 622m&#10;              # valley points in wipp &amp; ziller valley for stability plots (where valleys are narrow):&#10;              &quot;wipp_valley&quot;: {&quot;name&quot;: &quot;wipp valley&quot;, &quot;lat&quot;: 47.13, &quot;lon&quot;: 11.45, &quot;height&quot;: 1044},&#10;              # between Schönberg &amp; Matrei&#10;              &quot;ziller_valley&quot;: {&quot;name&quot;: &quot;ziller valley&quot;, &quot;lat&quot;: 47.25, &quot;lon&quot;: 11.9, &quot;height&quot;: 565},&#10;              # between Zell am Ziller &amp; Zillertal&#10;              &quot;ziller_ried&quot;: {&quot;name&quot;: &quot;ziller ried&quot;, &quot;lat&quot;: 47.3, &quot;lon&quot;: 11.87, &quot;height&quot;: 572}  # Zillertal, Kaltenbach&#10;              }&#10;POINT_NAMES = list(ALL_POINTS.keys())  # list w. all point names&#10;# coordinates of points used for Daniels' Analysis; all points that should include HATPRO or Radiosonde data in&#10;# the point plots need &quot;ibk&quot; in the beginning of point definition&#10;# heights in m from https://www.freemaptools.com/elevation-finder.htm&#10;&#10;# List of point keys for easy iteration - coordinates of points used for Daniels' Analysis&#10;# Points that should include HATPRO plot (VHD) need &quot;ibk&quot; in name&#10;# Heights in m from https://www.freemaptools.com/elevation-finder.htm&#10;&#10;# Define point categories for easy filtering; hardcoded list to distinguish valley and mountain points&#10;VALLEY_POINTS = [&quot;ibk_villa&quot;, &quot;ibk_uni&quot;, &quot;ibk_airport&quot;, &quot;woergl&quot;, &quot;kiefersfelden&quot;, &quot;telfs&quot;, &quot;wipp_valley&quot;,&#10;                 &quot;ziller_valley&quot;, &quot;ziller_ried&quot;]&#10;MOUNTAIN_SLOPE_POINTS = [&quot;hafelkar&quot;, &quot;slope_north_patscherkofel&quot;]&#10;&#10;&#10;def get_valley_points_only():&#10;    &quot;&quot;&quot;Get only valley points (excludes mountains and slopes)&quot;&quot;&quot;&#10;    return {key: value for key, value in ALL_POINTS.items() if key in VALLEY_POINTS}&#10;&#10;&#10;def get_points_excluding_mountains():&#10;    &quot;&quot;&quot;Get all points except mountain/slope points&quot;&quot;&quot;&#10;    return {key: value for key, value in ALL_POINTS.items() if key not in MOUNTAIN_SLOPE_POINTS}&#10;&#10;&#10;lat_hf_min, lat_hf_max = 47, 47.6&#10;lon_hf_min, lon_hf_max = 11.1, 12.1&#10;&#10;lat_min_vhd, lat_max_vhd = 47, 47.7  # orig: 47, 47.7    # lat &amp; lon values for vhd domain plotting&#10;lon_min_vhd, lon_max_vhd = 10.8, 12  # 10.8, 12&#10;&#10;lat_min_cap_height, lat_max_cap_height = 47, 48.2&#10;lon_min_cap_height, lon_max_cap_height = 10.6, 13&#10;&#10;lat_min, lat_max = 46.5, 48.2&#10;lon_min, lon_max = 9.2, 13&#10;&#10;# -------------------------------------------------------------------------------------------------------------&#10;radiosonde_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;Radiosonde&quot;)&#10;radiosonde_csv = os.path.join(radiosonde_folder,&#10;                              &quot;2017101603_bufr309052.csv&quot;)  # radiosonden aufstieg at innsbruck airport&#10;# deprecated: radiosonde_edited = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_2017101603.csv&quot;)  # calculated pot. temp &amp; rho&#10;# from other vars&#10;radiosonde_dataset = os.path.join(radiosonde_folder,&#10;                                  &quot;radiosonde_ibk_2017101603.nc&quot;)  # for same handling for plots &amp; calcs  save&#10;# Radiosonde as dataset&#10;# radiosonde_dataset_height_as_z = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_2017101603_height_as_z.nc&quot;)  # deprecated,&#10;# use fct in réad_in_hatpro_radiosonde.py&#10;# only geopot. height instead of &quot;height values&quot;&#10;# deprecated? radiosonde_smoothed = os.path.join(radiosonde_folder, &quot;radiosonde_ibk_smoothed.nc&quot;)&#10;&#10;all_model_topographies = os.path.join(model_folder, &quot;AROME&quot;,&#10;                                      &quot;all_model_topographies.nc&quot;)  # all topography-values extracted (lowest&#10;# lvl) of geopot. height + &quot;hgt&quot; - vars for AROME &amp; WRF and put into one file&#10;&#10;JSON_TIROL = os.path.join(data_folder, &quot;Height&quot;, &quot;gadm41_AUT_1.json&quot;)  # tirol json file&#10;DEMFILE_CLIP = os.path.join(data_folder, &quot;Height&quot;, &quot;dem_clipped.tif&quot;)  # dem file (höhe)&#10;TIROL_DEMFILE = os.path.join(data_folder, &quot;Height&quot;, &quot;dem.tif&quot;)  # changed dem file: indexed and renamed coords&#10;dem_smoothed = os.path.join(data_folder, &quot;Height&quot;, &quot;dem_smoothed.tif&quot;)&#10;filepath_arome_height = os.path.join(model_folder, &quot;AROME&quot;, &quot;AROME_TEAMx_CAP_3D_fields&quot;,&#10;                                     &quot;AROME_Geosphere_20171015T1200Z_CAP02_3D_30min_1km_best_z.nc&quot;)&#10;dem_file_hobos_extent = os.path.join(data_folder, &quot;Height&quot;,&#10;                                     &quot;dem_cut_hobos.tif&quot;)  # created DEM (in model_topography) to see real&#10;# heights with HOBOS&#10;&#10;# ZAMG Datahub files&#10;kufstein_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                             &quot;data_station9016-Kufstein_20171012_20171018.csv&quot;)&#10;kufstein_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_station9016_Kufstein_new.csv&quot;)&#10;&#10;innsbruck_uni_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                  &quot;data_station11803-InnsbruckUniversity_20171012_20171018.csv&quot;)&#10;innsbruck_uni_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                      &quot;data_station11803-InnsbruckUniversity_new.csv&quot;)&#10;innsbruck_airport_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                      &quot;data_station11804-InnsbruckAirport_20171012_20171018.csv&quot;)&#10;innsbruck_airport_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                                          &quot;data_station11804-InnsbruckAirport_new.csv&quot;)&#10;&#10;jenbach_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                            &quot;data_station11901-Jenbach_20171012_20171018.csv&quot;)&#10;jenbach_zamg_new = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_station11901-Jenbach_new.csv&quot;)&#10;&#10;rinn_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;,&#10;                         &quot;data_station11123-Rinn_20171015T1200_20171016T1210.csv&quot;)&#10;munchen_zamg = os.path.join(data_folder, &quot;Observations&quot;, &quot;ZAMG_Tawes&quot;, &quot;data_munich_T2m.csv&quot;)&#10;&#10;# mobile stations, cut to our period&#10;momma_our_period_file = os.path.join(data_folder, &quot;Observations&quot;, &quot;MOMMA&quot;, &quot;MOMMA_our_period.nc&quot;)&#10;&#10;# ----------------------------------Models-----------------------------------------------------&#10;&#10;# absolute paths AROME&#10;dir_AROME = os.path.join(model_folder, &quot;AROME&quot;)&#10;dir_2D_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_2D_fields&quot;)&#10;dir_3D_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_3D_fields&quot;)&#10;dir_timeseries_AROME = os.path.join(dir_AROME, &quot;AROME_TEAMx_CAP_timeseries&quot;)&#10;&#10;# absolute paths WRF&#10;wrf_folder = os.path.join(model_folder, &quot;WRF_ACINN&quot;)  # before: wrf_ACINN&#10;&#10;# absolute paths ICON&#10;icon_folder_3D = os.path.join(model_folder, &quot;ICON&quot;)&#10;icon_folder_meteogram = os.path.join(model_folder, &quot;icon&quot;, &quot;ICON_Meteogram&quot;)  # ?&#10;&#10;# absolute paths ICON2TE&#10;icon2TE_folder_3D = os.path.join(model_folder, &quot;ICON2TE&quot;)&#10;&#10;# absolute Path UKMO&#10;ukmo_folder = os.path.join(model_folder, &quot;ukmo&quot;)&#10;&#10;# ------------------------------colormaps for plotting ---------------------------------------------&#10;from colorspace import qualitative_hcl&#10;&#10;# --- Color scheme for models (consistent with plot_cap_height) ---&#10;qualitative_colors_temp = qualitative_hcl(palette=&quot;Dark 3&quot;).colors()&#10;qualitative_colors_wind = qualitative_colors_temp&#10;qualitative_colors_humidity = qualitative_hcl(palette=&quot;Dark 3&quot;).colors()&#10;&#10;# Model color mapping for temperature - ICON and ICON2TE share the same color; take same color for LIDAR88 and HATPRO&#10;model_colors_temp_wind = {&quot;AROME&quot;: qualitative_colors_temp[0], &quot;ICON&quot;: qualitative_colors_temp[2],&#10;                          &quot;ICON2TE&quot;: qualitative_colors_temp[2], &quot;UM&quot;: qualitative_colors_temp[4],&#10;                          &quot;WRF&quot;: qualitative_colors_temp[6], &quot;Radiosonde&quot;: qualitative_colors_temp[10],&#10;                          &quot;HATPRO&quot;: qualitative_colors_temp[8], &quot;LIDAR88&quot;: qualitative_colors_temp[8],&#10;                          &quot;LIDAR142&quot;: qualitative_colors_temp[9]}&#10;&#10;# Model color mapping for humidity&#10;model_colors_humidity = {&quot;AROME&quot;: qualitative_colors_humidity[0], &quot;ICON&quot;: qualitative_colors_humidity[2],&#10;                         &quot;ICON2TE&quot;: qualitative_colors_humidity[2], &quot;UM&quot;: qualitative_colors_humidity[4],&#10;                         &quot;WRF&quot;: qualitative_colors_humidity[6], &quot;Radiosonde&quot;: qualitative_colors_humidity[10],&#10;                         &quot;HATPRO&quot;: qualitative_colors_humidity[8]}&#10;&#10;# define linestyle for ICON2TE&#10;icon_2te_hatpro_linestyle = &quot;dot&quot;&#10;&#10;# -------------------------------Data and Plot paths -----------------------------------------------&#10;&#10;# EC stations&#10;dir_EC_stations = f&quot;{data_folder}/Observations/EC_4_stations&quot;&#10;EC_30min_final = f&quot;{dir_EC_stations}/EC_30min_file.nc&quot;&#10;EC_1min_final = f&quot;{dir_EC_stations}/EC_1min_file.nc&quot;&#10;&#10;# Ibox dir&#10;ibox_folder = f&quot;{data_folder}/Observations/Ibox&quot;&#10;&#10;# HOBOS station&#10;hobos_file = f&quot;{data_folder}/Observations/HOBOS/hobos_final.nc&quot;  # Observations/HOBOS/&#10;&#10;# Lidar obs&#10;lidar_obs_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;LIDAR&quot;)&#10;lidar_sl88 = os.path.join(lidar_obs_folder, &quot;SL88_vad_l2&quot;)  # add trailing separator for consistency&#10;lidar_slxr142 = os.path.join(lidar_obs_folder, &quot;SLXR142_vad_l2&quot;)&#10;# merged files, subsetted to period and 30 min intervals are saved in:&#10;lidar_sl88_merged_path = os.path.join(lidar_sl88, 'sl88_merged.nc')&#10;lidar_slxr142_merged_path = os.path.join(lidar_slxr142, 'slxr142_merged.nc')&#10;&#10;# HATPRO obs&#10;hatpro_folder = os.path.join(data_folder, &quot;Observations&quot;, &quot;HATPRO_obs&quot;)  # nicht vorhanden?&#10;hatpro_merged = os.path.join(hatpro_folder, &quot;hatpro_merged.nc&quot;)  # + &quot;hatpro_merged.nc&quot;&#10;hatpro_smoothed = os.path.join(hatpro_folder, &quot;hatpro_smoothed.nc&quot;)&#10;hatpro_calced_vars = os.path.join(hatpro_folder, &quot;hatpro_calced_vars_from_arome_p_height_as_z.nc&quot;)&#10;hatpro_with_cap_height = os.path.join(hatpro_folder, &quot;hatpro_interpolated_arome_height_as_z_with_cap_height.nc&quot;)&#10;&#10;# Radiosonde CAP height is 1537 m (searched by hand) - ibk_airport[&quot;height&quot;] = 960 m&#10;radiosonde_cap_height = 1537 - ALL_POINTS[&quot;ibk_airport&quot;][&quot;height&quot;]&#10;# deprecated ones?&#10;# hatpro_interp_arome = hatpro_folder + &quot;hatpro_interpolated_arome.nc&quot;&#10;# hatpro_interp_arome_height_as_z = hatpro_folder + &quot;hatpro_interpolated_arome_height_as_z.nc&quot;&#10;&#10;&#10;# Define colors for the models to use the same in each plot:&#10;colordict = {&quot;HOBOS&quot;: &quot;purple&quot;, &quot;ICON&quot;: &quot;orange&quot;, &quot;RADIOSONDE&quot;: &quot;black&quot;, &quot;AROME&quot;: &quot;red&quot;, &quot;HATPRO&quot;: &quot;gray&quot;,&#10;             &quot;UKMO&quot;: &quot;green&quot;, &quot;WRF_ACINN&quot;: &quot;blue&quot;}&#10;&#10;# Create a dictionary with information of the TAWES stations&#10;station_files_zamg = {&#10;    &quot;IAO&quot;: {&quot;filepath&quot;: innsbruck_uni_zamg, &quot;name&quot;: &quot;Innsbruck Uni&quot;, 'lon': 11.384167, 'lat': 47.259998,&#10;            'hoehe': 578, },&#10;    &quot;JEN&quot;: {&quot;filepath&quot;: jenbach_zamg, &quot;name&quot;: &quot;Jenbach&quot;, 'lat': 47.388889, 'lon': 11.758056, 'hoehe': 530, },&#10;    &quot;KUF&quot;: {&quot;filepath&quot;: kufstein_zamg, &quot;name&quot;: &quot;Kufstein&quot;, 'lon': 12.162778, 'lat': 47.575279, 'hoehe': 490, },&#10;    &quot;LOWI&quot;: {&quot;filepath&quot;: innsbruck_airport_zamg, &quot;name&quot;: &quot;Innsbruck Airport&quot;, 'lat': 47.2598, 'lon': 11.3553,&#10;             'hoehe': 578, }, &quot;IMST&quot;: {  # &quot;filepath&quot;: imst_zamg,&#10;        &quot;name&quot;: &quot;Imst&quot;, 'lat': 47.2419, 'lon': 10.7218, 'hoehe': 828, }}&#10;&#10;# created a NEW dic with new zamg files:&#10;station_files_zamg_new = {&#10;    &quot;IAO&quot;: {&quot;filepath&quot;: innsbruck_uni_zamg_new, &quot;name&quot;: &quot;Innsbruck Uni&quot;, 'lon': 11.384167, 'lat': 47.259998,&#10;            'hoehe': ALL_POINTS[&quot;ibk_uni&quot;][&quot;height&quot;], },  # set to 612m, Uni roof!&#10;    &quot;JEN&quot;: {&quot;filepath&quot;: jenbach_zamg_new, &quot;name&quot;: &quot;Jenbach&quot;, 'lat': 47.388889, 'lon': 11.758056, 'hoehe': 530, },&#10;    &quot;KUF&quot;: {&quot;filepath&quot;: kufstein_zamg_new, &quot;name&quot;: &quot;Kufstein&quot;, 'lon': 12.162778, 'lat': 47.575279, 'hoehe': 490, },&#10;    &quot;LOWI&quot;: {&quot;filepath&quot;: innsbruck_airport_zamg_new, &quot;name&quot;: &quot;Innsbruck Airport&quot;, 'lat': 47.2598, 'lon': 11.3553,&#10;             'hoehe': 578, }, &quot;IMST&quot;: {  # &quot;filepath&quot;: imst_zamg,&#10;        &quot;name&quot;: &quot;Imst&quot;, 'lat': 47.2419, 'lon': 10.7218, 'hoehe': 828, }}&#10;&#10;# create a dict with info about the IBOX stations&#10;stations_ibox = {&#10;    &quot;VF0&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/vf0.csv&quot;, &quot;name&quot;: &quot;Kolsass&quot;, &quot;latitude&quot;: 47.305, &quot;longitude&quot;: 11.622,&#10;            &quot;height&quot;: 545},&#10;    &quot;SF8&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/sf8.csv&quot;, &quot;name&quot;: &quot;Terfens&quot;, &quot;latitude&quot;: 47.326, &quot;longitude&quot;: 11.652,&#10;            &quot;height&quot;: 575},&#10;    &quot;SF1&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/sf1.csv&quot;, &quot;name&quot;: &quot;Eggen&quot;, &quot;latitude&quot;: 47.317, &quot;longitude&quot;: 11.616,&#10;            &quot;height&quot;: 829},&#10;    &quot;NF10&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/nf10.csv&quot;, &quot;name&quot;: &quot;Weerberg&quot;, &quot;latitude&quot;: 47.300, &quot;longitude&quot;: 11.673,&#10;             &quot;height&quot;: 930},&#10;    &quot;NF27&quot;: {&quot;filepath&quot;: f&quot;{ibox_folder}/nf27.csv&quot;, &quot;name&quot;: &quot;Hochhaeuser&quot;, &quot;latitude&quot;: 47.288, &quot;longitude&quot;: 11.631,&#10;             &quot;height&quot;: 1009}}&#10;&#10;# dict with infos about EC stations&#10;ec_station_names = {1: {&quot;name&quot;: &quot;Patsch_EC_South&quot;, &quot;lat&quot;: 47.209068, &quot;lon&quot;: 11.411932},&#10;                    0: {&quot;name&quot;: &quot;Innsbruck_Airport_EC_West&quot;, &quot;lat&quot;: 47.255375, &quot;lon&quot;: 11.342832},&#10;                    2: {&quot;name&quot;: &quot;Thaur_EC_East&quot;, &quot;lat&quot;: 47.281335, &quot;lon&quot;: 11.474532},&#10;                    3: {&quot;name&quot;: &quot;IAO_Centre_Innsbruck_EC_Center&quot;, &quot;lat&quot;: 47.264035, &quot;lon&quot;: 11.385707}}&#10;&#10;# variables, units 2D AROME&#10;variables_units_2D_AROME = {'hfs': 'W/m²',  # Sensible heat flux at the surface&#10;                            'hgt': 'm',  # Surface geopotential height&#10;                            'lfs': 'W/m²',  # Latent heat flux at the surface&#10;                            'lwd': 'W/m²',  # Longwave incoming radiation at the surface&#10;                            'lwnet': 'W/m²',  # Longwave net radiation at the surface&#10;                            'lwu': 'W/m²',  # Longwave outgoing radiation at the surface (derived: lwnet - lwd)&#10;                            'pre': 'kg/m²',  # Surface precipitation (same as mm)&#10;                            'ps': 'Pa',  # Surface pressure&#10;                            'swd': 'W/m²',  # Shortwave incoming radiation at the surface&#10;                            'swnet': 'W/m²',  # Shortwave net radiation at the surface&#10;                            'swu': 'W/m²',  # Shortwave reflected radiation at the surface (derived: swnet - swd)&#10;                            'tsk': 'K'  # Surface temperature (Oberflächentemperatur)&#10;                            }&#10;&#10;# variables, units 3D AROME&#10;variables_units_3D_AROME = {'ciwc': 'kg/kg',  # Specific cloud ice water content&#10;                            'clwc': 'kg/kg',  # Specific cloud liquid water content&#10;                            'p': 'Pa',  # Pressure&#10;                            'q': 'kg/kg',  # Specific humidity&#10;                            'th': 'K',  # Potential temperature&#10;                            'tke': 'm²/s²',  # Turbulent kinetic energy&#10;                            'u': 'm/s',  # Zonal wind component&#10;                            'v': 'm/s',  # Meridional wind component&#10;                            'w': 'm/s',  # Vertical wind velocity&#10;                            'z': 'm',  # Geopotential height&#10;                            }&#10;&#10;# Define colors for the cities, used e.g. in temperature timeseries&#10;cities = {&#10;    'Innsbruck Uni': {'lon': 11.384167, 'lat': 47.259998, 'csv': innsbruck_uni_zamg, 'color': &quot;red&quot;, 'hoehe': 578, },&#10;    'Kufstein': {'lon': 12.162778, 'lat': 47.575279, 'csv': kufstein_zamg, 'color': &quot;blue&quot;, 'hoehe': 490, },&#10;    'Innsbruck Airport': {'lat': 47.2598, 'lon': 11.3553, 'csv': innsbruck_airport_zamg, 'color': &quot;green&quot;,&#10;                          'hoehe': 578, },&#10;    'Jenbach': {'lat': 47.388889, 'lon': 11.758056, 'csv': jenbach_zamg, 'color': &quot;gray&quot;, 'hoehe': 530, },&#10;    'Rinn': {'lat': 47.249168, 'lon': 11.503889, 'csv': rinn_zamg, 'color': &quot;purple&quot;, 'hoehe': 924},&#10;    'Muenchen': {'lat': 48.149723, 'lon': 11.540523, 'color': &quot;orange&quot;, 'hoehe': 521, 'csv': munchen_zamg&#10;                 # Replace 'munchen_zamg' with the actual path to your CSV file if you have data for München&#10;                 }}&#10;&#10;# information about MOMMA stations&#10;MOMMA_stations = {&quot;0&quot;: &quot;Völs&quot;, &quot;1&quot;: &quot;Innsbruck_Bergisel&quot;, &quot;2&quot;: &quot;Patsch_Pfaffenbichl&quot;, &quot;3&quot;: &quot;Innsbruck_Ölberg&quot;,&#10;                  &quot;4&quot;: &quot;Innsbruck_Hotel Hilton&quot;, &quot;5&quot;: &quot;Innsbruck_Saggen_Kettenbrücke&quot;, &quot;6&quot;: &quot;Volders&quot;,&#10;                  &quot;7&quot;: &quot;Unterperfuss&quot;, &quot;8&quot;: &quot;Inzing_Zirl_Modellflugplatz&quot;}&#10;&#10;MOMMA_stations_PM = {&#10;    &quot;PM02&quot;: {&quot;name&quot;: &quot;Völs&quot;, &quot;latitude&quot;: 47.2614791608, &quot;longitude&quot;: 11.3117537274, &quot;height&quot;: 583, &quot;key&quot;: 0},&#10;    &quot;PM03&quot;: {&quot;name&quot;: &quot;Innsbruck_Bergisel&quot;, &quot;latitude&quot;: 47.2472604421, &quot;longitude&quot;: 11.3986000093, &quot;height&quot;: 726,&#10;             &quot;key&quot;: 1},&#10;    &quot;PM04&quot;: {&quot;name&quot;: &quot;Patsch_Pfaffenbichl&quot;, &quot;latitude&quot;: 47.21030188, &quot;longitude&quot;: 11.4105114057, &quot;height&quot;: 983,&#10;             &quot;key&quot;: 2},&#10;    &quot;PM05&quot;: {&quot;name&quot;: &quot;Innsbruck_Ölberg&quot;, &quot;latitude&quot;: 47.2784241867, &quot;longitude&quot;: 11.3902967638, &quot;height&quot;: 722,&#10;             &quot;key&quot;: 3},&#10;    &quot;PM06&quot;: {&quot;name&quot;: &quot;Innsbruck_Hotel Hilton&quot;, &quot;latitude&quot;: 47.2620425014, &quot;longitude&quot;: 11.3959606669, &quot;height&quot;: 629,&#10;             &quot;key&quot;: 4},&#10;    &quot;PM07&quot;: {&quot;name&quot;: &quot;Innsbruck_Saggen_Kettenbrücke&quot;, &quot;latitude&quot;: 47.2787431973, &quot;longitude&quot;: 11.4123320657,&#10;             &quot;height&quot;: 569, &quot;key&quot;: 5},&#10;    &quot;PM08&quot;: {&quot;name&quot;: &quot;Volders&quot;, &quot;latitude&quot;: 47.2930516284, &quot;longitude&quot;: 11.5697988436, &quot;height&quot;: 552, &quot;key&quot;: 6},&#10;    &quot;PM09&quot;: {&quot;name&quot;: &quot;Unterperfuss&quot;, &quot;latitude&quot;: 47.2615210341, &quot;longitude&quot;: 11.2607050096, &quot;height&quot;: 594, &quot;key&quot;: 7},&#10;    &quot;PM10&quot;: {&quot;name&quot;: &quot;Inzing_Zirl_Modellflugplatz&quot;, &quot;latitude&quot;: 47.2744017492, &quot;longitude&quot;: 11.2143291427,&#10;             &quot;height&quot;: 597, &quot;key&quot;: 8}}&#10;&#10;# units of lidar observations&#10;vars_lidar = {'u': 'm/s', 'v': 'm/s', 'w': 'm/s', 'ff': 'm/s', 'dd': 'degree'}&#10;&#10;# hatpro height information&#10;hatpro_vertical_levels = {&#10;    &quot;height_name&quot;: [&quot;V01&quot;, &quot;V02&quot;, &quot;V03&quot;, &quot;V04&quot;, &quot;V05&quot;, &quot;V06&quot;, &quot;V07&quot;, &quot;V08&quot;, &quot;V09&quot;, &quot;V10&quot;, &quot;V11&quot;, &quot;V12&quot;, &quot;V13&quot;, &quot;V14&quot;,&#10;                    &quot;V15&quot;, &quot;V16&quot;, &quot;V17&quot;, &quot;V18&quot;, &quot;V19&quot;, &quot;V20&quot;, &quot;V21&quot;, &quot;V22&quot;, &quot;V23&quot;, &quot;V24&quot;, &quot;V25&quot;, &quot;V26&quot;, &quot;V27&quot;, &quot;V28&quot;,&#10;                    &quot;V29&quot;, &quot;V30&quot;, &quot;V31&quot;, &quot;V32&quot;, &quot;V33&quot;, &quot;V34&quot;, &quot;V35&quot;, &quot;V36&quot;, &quot;V37&quot;, &quot;V38&quot;, &quot;V39&quot;],&#10;    &quot;height&quot;: [&quot;0&quot;, &quot;10&quot;, &quot;30&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;, &quot;125&quot;, &quot;150&quot;, &quot;200&quot;, &quot;250&quot;, &quot;325&quot;, &quot;400&quot;, &quot;475&quot;, &quot;550&quot;, &quot;625&quot;, &quot;700&quot;,&#10;               &quot;800&quot;, &quot;900&quot;, &quot;1000&quot;, &quot;1150&quot;, &quot;1300&quot;, &quot;1450&quot;, &quot;1600&quot;, &quot;1800&quot;, &quot;2000&quot;, &quot;2200&quot;, &quot;2500&quot;, &quot;2800&quot;, &quot;3100&quot;,&#10;               &quot;3500&quot;, &quot;3900&quot;, &quot;4400&quot;, &quot;5000&quot;, &quot;5600&quot;, &quot;6200&quot;, &quot;7000&quot;, &quot;8000&quot;, &quot;9000&quot;, &quot;10000&quot;]}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/plot_timeseries.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/plot_timeseries.py" />
              <option name="originalContent" value="&quot;&quot;&quot;&#10;This script is used to plot the time series of the vertical distribution of potential temperature for all models.&#10;problem: vertical coordinate is not the same for all models =&gt; use pressure?&#10;&quot;&quot;&quot;&#10;&#10;# Fix for OpenMP duplicate library error on Windows&#10;import os&#10;os.environ['KMP_DUPLICATE_LIB_OK'] = 'TRUE'&#10;&#10;import sys&#10;sys.path.append(&quot;D:/MSc_Arbeit/model_comparison_codes&quot;)&#10;import importlib&#10;import read_in_arome&#10;import read_icon_model_3D&#10;import read_ukmo&#10;# importlib.reload(read_icon_model_3D)&#10;import read_wrf_helen&#10;importlib.reload(read_in_arome)&#10;import confg&#10;import xarray as xr&#10;import numpy as np&#10;import matplotlib&#10;import matplotlib.pyplot as plt&#10;import pandas as pd&#10;from colorspace import diverging_hcl&#10;&#10;&#10;&#10;def plot_pot_temp_time_contours(pot_temp, model=&quot;AROME&quot;):&#10;    &quot;&quot;&quot;&#10;    plot pot temp time &amp; height series for all models. HATPRO was interpolated to AROME levels &amp; it's pressure is used&#10;    to compute pot temp.&#10;    thin 1 K pot temp contour lines, thick 5 K pot temp contour lines and red/blue shading for the 1/2 hrly&#10;    warming/cooling in pot temp is plotted&#10;&#10;    :param pot_temp:&#10;    :param model:&#10;    :return:&#10;    &quot;&quot;&quot;&#10;    fig, ax = plt.subplots(figsize=(12, 6))&#10;&#10;    vmin, vmax = -2, 2  # uniform colorbar&#10;    levels = np.arange(vmin, vmax + 0.5, 0.5)&#10;    # limit the time range for the plot&#10;    start_time = pd.to_datetime('2017-10-15 13:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    end_time = pd.to_datetime('2017-10-16 12:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    # pot_temp = pot_temp.sel(time=slice(start_time, end_time))&#10;&#10;    # Plot the filled contours&#10;    contourf = (pot_temp.diff(&quot;time&quot;, n=1) * 2).plot.contourf(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=levels, cmap=pal1.cmap(),&#10;                                                   add_colorbar=False, vmin=vmin, vmax=vmax)&#10;&#10;    # Plot the contour lines&#10;    contour1 = pot_temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                     levels=np.arange(np.round(pot_temp.min()), np.round(pot_temp.max()), 1),&#10;                                     colors='black', linewidths=0.5)   #.isel(time=slice(1, 100))&#10;    contour5 = pot_temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=np.arange(290, np.round(pot_temp.max()), 5),&#10;                                     colors='black', linewidths=1.5)  #.isel(time=slice(1, 100))&#10;    ax.clabel(contour5)&#10;&#10;    ax.set_xlim(start_time, end_time)&#10;    # Add a colorbar&#10;    cbar = plt.colorbar(contourf, ax=ax)&#10;    cbar.set_label('K hr$^{-1}$')&#10;&#10;    ax.set_title(model + &quot; potential temp time series&quot;)&#10;    if model ==  &quot;HATPRO&quot;:&#10;        ax.set_ylabel(f&quot;height [m]&quot;)&#10;    elif model == &quot;ICON&quot; or model == &quot;ICON2TE&quot;:&#10;        ax.set_ylabel(f&quot;geometric height [m]&quot;)&#10;    else:&#10;        ax.set_ylabel(f&quot;geopotential height [m]&quot;)&#10;    ax.set_xlabel(&quot;&quot;)&#10;&#10;    plt.savefig(confg.dir_PLOTS + model + f&quot;_pot_temp_timeseries_{interface_height}_ibk.png&quot;, dpi=500)&#10;&#10;&#10;def plot_temp_time_contours(temp, model=&quot;AROME&quot;):&#10;    &quot;&quot;&quot;&#10;    plot temp over time &amp; height for all models incl HATPRO.&#10;    :param temp:&#10;    :param model:&#10;    :return:&#10;    &quot;&quot;&quot;&#10;&#10;    fig, ax = plt.subplots(figsize=(12, 6))&#10;&#10;    vmin, vmax = -1.5, 1.5  # uniform colorbar&#10;    levels = np.arange(vmin, vmax + 0.3, 0.3)&#10;&#10;    start_time = pd.to_datetime('2017-10-15 14:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    end_time = pd.to_datetime('2017-10-16 12:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    # temp = temp.sel(time=slice(start_time, end_time))&#10;&#10;    # Plot the filled contours&#10;    contourf = temp.diff(&quot;time&quot;).plot.contourf(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=levels, cmap=pal1.cmap(),&#10;                                                   add_colorbar=False, vmin=-2, vmax=2)&#10;&#10;    # Plot the contour lines&#10;    contour1 = temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                                                    levels=np.arange(np.round(temp.min()),&#10;                                                                                     np.round(temp.max()), 1),&#10;                                                                    colors='black', linewidths=0.5)   #.isel(time=slice(1, 100))&#10;    contour5 = temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                                                    levels=np.arange(-50, np.round(temp.max()), 5),&#10;                                                                    colors='black', linewidths=1.5)  #.isel(time=slice(1, 100))&#10;    ax.clabel(contour5)&#10;&#10;    ax.set_xlim(start_time, end_time)&#10;    # Add a colorbar&#10;    cbar = plt.colorbar(contourf, ax=ax)&#10;    cbar.set_label('K hr$^{-1}$')&#10;    ax.set_title(model + &quot; temp time series&quot;)&#10;    if model ==  &quot;HATPRO&quot;:&#10;        ax.set_ylabel(f&quot;height [m]&quot;)&#10;    else:&#10;        ax.set_ylabel(f&quot;geopotential height [m]&quot;)&#10;    ax.set_xlabel(&quot;&quot;)&#10;    plt.savefig(confg.dir_PLOTS + model + &quot;_temp_timeseries_ibk.png&quot;, dpi=300)&#10;    plt.show()&#10;&#10;&#10;def plot_arome():&#10;    # arome = read_in_arome.read_in_arome_fixed_point(lat=lat_ibk, lon=lon_ibk, )&#10;    # arome = read_in_arome.read_3D_variables_AROME(variables=[&quot;p&quot;, &quot;th&quot;, &quot;z&quot;], method=&quot;sel&quot;, lat=lat_ibk, lon=lon_ibk)&#10;    # pot_temp = arome.th.isel(nz=np.arange(40, 90))&#10;&#10;    arome = xr.open_dataset(confg.model_folder + &quot;/AROME/&quot; + &quot;AROME_temp_timeseries_ibk.nc&quot;)&#10;    pot_temp = arome.th.where(arome[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp, model=&quot;AROME&quot;)&#10;&#10;    # temp = arome.temperature.where(arome.height &lt;= 4000, drop=True)  # tried with normal temp, but you don't see much...&#10;    # plot_temp_time_contours(temp, model=&quot;AROME&quot;)&#10;&#10;def plot_icon():&#10;    &quot;&quot;&quot;icon15 = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=15, hours=np.arange(14, 23), lon=lon_ibk, lat=lat_ibk, variant=&quot;ICON&quot;)&#10;    icon16 = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=16, hours=np.arange(0, 9), lon=lon_ibk, lat=lat_ibk, variant=&quot;ICON&quot;)&#10;    variables = [&quot;th&quot;, &quot;temp&quot;, &quot;z_ifc&quot;]  # &quot;temp&quot;, &quot;pres&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;,&#10;    icon = xr.concat([icon15[variables], icon16[variables]], dim=&quot;time&quot;)&quot;&quot;&quot;&#10;    icon = xr.open_dataset(confg.icon_folder_3D + &quot;/ICON_temp_timeseries_ibk.nc&quot;)&#10;    pot_temp = icon.th.where(icon[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp, model=&quot;ICON&quot;)&#10;&#10;def plot_icon2te():&#10;    &quot;&quot;&quot;icon15_2te = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=15, hours=range(12, 24), lon=lon_ibk,&#10;                                                                         lat=lat_ibk, variant=&quot;ICON2TE&quot;)&#10;    icon16_2te = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=16, hours=range(00, 13), lon=lon_ibk,&#10;                                                                         lat=lat_ibk, variant=&quot;ICON2TE&quot;)&#10;    variables = [&quot;th&quot;, &quot;temp&quot;]  # [&quot;temp&quot;, &quot;pressure&quot;, &quot;pres&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;]&#10;    icon2te = xr.concat([icon15_2te[variables], icon16_2te[variables]], dim=&quot;time&quot;)&#10;    icon2te_pot_temp = icon2te.th.isel(height=np.arange(40, 90))&quot;&quot;&quot;&#10;&#10;    icon_2te = xr.open_dataset(confg.icon2TE_folder_3D + &quot;/ICON_2TE_latlon_temp_timeseries_ibk.nc&quot;)&#10;    icon_2te_pot_temp = icon_2te.th.where(icon_2te[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp=icon_2te_pot_temp, model=&quot;ICON2TE_latlon&quot;)&#10;&#10;def plot_ukmo():&#10;    um = xr.open_dataset(confg.ukmo_folder + &quot;/UKMO_temp_timeseries_ibk.nc&quot;)&#10;    um_pot_temp = um.th.where(um[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;&#10;    plot_pot_temp_time_contours(pot_temp=um_pot_temp, model=&quot;UKMO&quot;)&#10;&#10;def plot_wrf():&#10;    # wrf = read_wrf_helen.read_wrf_fixed_point(lat=lat_ibk, lon=lon_ibk)&#10;    # wrf_pot_temp = wrf.th.isel(height=slice(0, 50))&#10;&#10;    wrf = xr.open_dataset(confg.wrf_folder + &quot;/WRF_temp_timeseries_ibk.nc&quot;)&#10;    wrf_pot_temp = wrf.th.where(wrf[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;&#10;    plot_pot_temp_time_contours(pot_temp=wrf_pot_temp, model=&quot;WRF&quot;)&#10;&#10;&#10;def plot_hatpro():&#10;    # hatpro = xr.open_dataset(f&quot;{confg.hatpro_folder}/hatpro_merged.nc&quot;)&#10;    # hatpro_temp = hatpro[&quot;temperature&quot;].sel(height=slice(0, 4400))  # select up to 4.400 m&#10;    # plot_temp_time_contours(temp=hatpro_temp, model=&quot;HATPRO&quot;)&#10;    # hatpro&#10;&#10;    # try with hatpro interpolated data&#10;    hatpro = xr.open_dataset(f&quot;{confg.hatpro_folder}/hatpro_interpolated_arome.nc&quot;)&#10;    hatpro_pot_temp = hatpro[&quot;th&quot;].where(hatpro[&quot;height&quot;] &lt;= interface_height, drop=True)  # hatpro[&quot;th&quot;].sel(height=slice(0, 4400))  # select up to 4.400 m&#10;    plot_pot_temp_time_contours(pot_temp=hatpro_pot_temp, model=&quot;HATPRO&quot;)&#10;&#10;if __name__ == '__main__':&#10;    lat_ibk = 47.259998&#10;    lon_ibk = 11.384167&#10;    interface_height = 2500  # what is max height that should be plotted?&#10;    pal1 = diverging_hcl(palette=&quot;Blue-Red 2&quot;)&#10;&#10;    matplotlib.use('Qt5Agg')  # Use the Qt5Agg backend for interactive plotting&#10;&#10;    #plot_arome()&#10;&#10;    plot_icon()&#10;    plot_icon2te()&#10;&#10;    #plot_ukmo()&#10;    #plot_wrf()&#10;    #plot_hatpro()&#10;    plt.show()&#10;" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;This script is used to plot the time series of the vertical distribution of potential temperature for all models.&#10;problem: vertical coordinate is not the same for all models =&gt; use pressure?&#10;&quot;&quot;&quot;&#10;&#10;# Fix for OpenMP duplicate library error on Windows&#10;import os&#10;os.environ['KMP_DUPLICATE_LIB_OK'] = 'TRUE'&#10;&#10;import sys&#10;sys.path.append(&quot;D:/MSc_Arbeit/model_comparison_codes&quot;)&#10;import importlib&#10;import read_in_arome&#10;import read_icon_model_3D&#10;import read_ukmo&#10;# importlib.reload(read_icon_model_3D)&#10;import read_wrf_helen&#10;importlib.reload(read_in_arome)&#10;import confg&#10;import xarray as xr&#10;import numpy as np&#10;import matplotlib&#10;import matplotlib.pyplot as plt&#10;import pandas as pd&#10;from colorspace import diverging_hcl&#10;&#10;&#10;&#10;def plot_pot_temp_time_contours(pot_temp, model=&quot;AROME&quot;):&#10;    &quot;&quot;&quot;&#10;    plot pot temp time &amp; height series for all models. HATPRO was interpolated to AROME levels &amp; it's pressure is used&#10;    to compute pot temp.&#10;    thin 1 K pot temp contour lines, thick 5 K pot temp contour lines and red/blue shading for the 1/2 hrly&#10;    warming/cooling in pot temp is plotted&#10;&#10;    :param pot_temp:&#10;    :param model:&#10;    :return:&#10;    &quot;&quot;&quot;&#10;    fig, ax = plt.subplots(figsize=(12, 6))&#10;&#10;    vmin, vmax = -2, 2  # uniform colorbar&#10;    levels = np.arange(vmin, vmax + 0.5, 0.5)&#10;    # limit the time range for the plot&#10;    start_time = pd.to_datetime('2017-10-15 13:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    end_time = pd.to_datetime('2017-10-16 12:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    # pot_temp = pot_temp.sel(time=slice(start_time, end_time))&#10;&#10;    # Plot the filled contours&#10;    contourf = (pot_temp.diff(&quot;time&quot;, n=1) * 2).plot.contourf(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=levels, cmap=pal1.cmap(),&#10;                                                   add_colorbar=False, vmin=vmin, vmax=vmax)&#10;&#10;    # Plot the contour lines&#10;    contour1 = pot_temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                     levels=np.arange(np.round(pot_temp.min()), np.round(pot_temp.max()), 1),&#10;                                     colors='black', linewidths=0.5)   #.isel(time=slice(1, 100))&#10;    contour5 = pot_temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=np.arange(290, np.round(pot_temp.max()), 5),&#10;                                     colors='black', linewidths=1.5)  #.isel(time=slice(1, 100))&#10;    ax.clabel(contour5)&#10;&#10;    ax.set_xlim(start_time, end_time)&#10;    # Add a colorbar&#10;    cbar = plt.colorbar(contourf, ax=ax)&#10;    cbar.set_label('K hr$^{-1}$')&#10;&#10;    ax.set_title(model + &quot; potential temp time series&quot;)&#10;    if model ==  &quot;HATPRO&quot;:&#10;        ax.set_ylabel(f&quot;height [m]&quot;)&#10;    elif model == &quot;ICON&quot; or model == &quot;ICON2TE&quot;:&#10;        ax.set_ylabel(f&quot;geometric height [m]&quot;)&#10;    else:&#10;        ax.set_ylabel(f&quot;geopotential height [m]&quot;)&#10;    ax.set_xlabel(&quot;&quot;)&#10;&#10;    plt.savefig(confg.dir_PLOTS + model + f&quot;_pot_temp_timeseries_{interface_height}_ibk.png&quot;, dpi=500)&#10;&#10;&#10;def plot_temp_time_contours(temp, model=&quot;AROME&quot;):&#10;    &quot;&quot;&quot;&#10;    plot temp over time &amp; height for all models incl HATPRO.&#10;    :param temp:&#10;    :param model:&#10;    :return:&#10;    &quot;&quot;&quot;&#10;&#10;    fig, ax = plt.subplots(figsize=(12, 6))&#10;&#10;    vmin, vmax = -1.5, 1.5  # uniform colorbar&#10;    levels = np.arange(vmin, vmax + 0.3, 0.3)&#10;&#10;    start_time = pd.to_datetime('2017-10-15 14:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    end_time = pd.to_datetime('2017-10-16 12:00:00', format='%Y-%m-%d %H:%M:%S')&#10;    # temp = temp.sel(time=slice(start_time, end_time))&#10;&#10;    # Plot the filled contours&#10;    contourf = temp.diff(&quot;time&quot;).plot.contourf(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;, levels=levels, cmap=pal1.cmap(),&#10;                                                   add_colorbar=False, vmin=-2, vmax=2)&#10;&#10;    # Plot the contour lines&#10;    contour1 = temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                                                    levels=np.arange(np.round(temp.min()),&#10;                                                                                     np.round(temp.max()), 1),&#10;                                                                    colors='black', linewidths=0.5)   #.isel(time=slice(1, 100))&#10;    contour5 = temp.plot.contour(ax=ax, x=&quot;time&quot;, y=&quot;height&quot;,&#10;                                                                    levels=np.arange(-50, np.round(temp.max()), 5),&#10;                                                                    colors='black', linewidths=1.5)  #.isel(time=slice(1, 100))&#10;    ax.clabel(contour5)&#10;&#10;    ax.set_xlim(start_time, end_time)&#10;    # Add a colorbar&#10;    cbar = plt.colorbar(contourf, ax=ax)&#10;    cbar.set_label('K hr$^{-1}$')&#10;    ax.set_title(model + &quot; temp time series&quot;)&#10;    if model ==  &quot;HATPRO&quot;:&#10;        ax.set_ylabel(f&quot;height [m]&quot;)&#10;    else:&#10;        ax.set_ylabel(f&quot;geopotential height [m]&quot;)&#10;    ax.set_xlabel(&quot;&quot;)&#10;    plt.savefig(confg.dir_PLOTS + model + &quot;_temp_timeseries_ibk.png&quot;, dpi=300)&#10;    plt.show()&#10;&#10;&#10;def plot_arome():&#10;    # arome = read_in_arome.read_in_arome_fixed_point(lat=lat_ibk, lon=lon_ibk, )&#10;    # arome = read_in_arome.read_3D_variables_AROME(variables=[&quot;p&quot;, &quot;th&quot;, &quot;z&quot;], method=&quot;sel&quot;, lat=lat_ibk, lon=lon_ibk)&#10;    # pot_temp = arome.th.isel(nz=np.arange(40, 90))&#10;&#10;    arome = xr.open_dataset(confg.model_folder + &quot;/AROME/&quot; + &quot;AROME_temp_timeseries_ibk.nc&quot;)&#10;    pot_temp = arome.th.where(arome[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp, model=&quot;AROME&quot;)&#10;&#10;    # temp = arome.temperature.where(arome.height &lt;= 4000, drop=True)  # tried with normal temp, but you don't see much...&#10;    # plot_temp_time_contours(temp, model=&quot;AROME&quot;)&#10;&#10;def plot_icon():&#10;    &quot;&quot;&quot;icon15 = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=15, hours=np.arange(14, 23), lon=lon_ibk, lat=lat_ibk, variant=&quot;ICON&quot;)&#10;    icon16 = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=16, hours=np.arange(0, 9), lon=lon_ibk, lat=lat_ibk, variant=&quot;ICON&quot;)&#10;    variables = [&quot;th&quot;, &quot;temp&quot;, &quot;z_ifc&quot;]  # &quot;temp&quot;, &quot;pres&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;,&#10;    icon = xr.concat([icon15[variables], icon16[variables]], dim=&quot;time&quot;)&quot;&quot;&quot;&#10;    icon = xr.open_dataset(confg.icon_folder_3D + &quot;/ICON_temp_timeseries_ibk.nc&quot;)&#10;    pot_temp = icon.th.where(icon[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp, model=&quot;ICON&quot;)&#10;&#10;def plot_icon2te():&#10;    &quot;&quot;&quot;icon15_2te = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=15, hours=range(12, 24), lon=lon_ibk,&#10;                                                                         lat=lat_ibk, variant=&quot;ICON2TE&quot;)&#10;    icon16_2te = read_icon_model_3D.read_icon_fixed_point_multiple_hours(day=16, hours=range(00, 13), lon=lon_ibk,&#10;                                                                         lat=lat_ibk, variant=&quot;ICON2TE&quot;)&#10;    variables = [&quot;th&quot;, &quot;temp&quot;]  # [&quot;temp&quot;, &quot;pressure&quot;, &quot;pres&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;]&#10;    icon2te = xr.concat([icon15_2te[variables], icon16_2te[variables]], dim=&quot;time&quot;)&#10;    icon2te_pot_temp = icon2te.th.isel(height=np.arange(40, 90))&quot;&quot;&quot;&#10;&#10;    icon_2te = xr.open_dataset(confg.icon2TE_folder_3D + &quot;/ICON_2TE_latlon_temp_timeseries_ibk.nc&quot;)&#10;    icon_2te_pot_temp = icon_2te.th.where(icon_2te[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;    plot_pot_temp_time_contours(pot_temp=icon_2te_pot_temp, model=&quot;ICON2TE_latlon&quot;)&#10;&#10;def plot_ukmo():&#10;    um = xr.open_dataset(confg.ukmo_folder + &quot;/UKMO_temp_timeseries_ibk.nc&quot;)&#10;    um_pot_temp = um.th.where(um[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;&#10;    plot_pot_temp_time_contours(pot_temp=um_pot_temp, model=&quot;UKMO&quot;)&#10;&#10;def plot_wrf():&#10;    # wrf = read_wrf_helen.read_wrf_fixed_point(lat=lat_ibk, lon=lon_ibk)&#10;    # wrf_pot_temp = wrf.th.isel(height=slice(0, 50))&#10;&#10;    wrf = xr.open_dataset(confg.wrf_folder + &quot;/WRF_temp_timeseries_ibk.nc&quot;)&#10;    wrf_pot_temp = wrf.th.where(wrf[&quot;height&quot;] &lt;= interface_height, drop=True)&#10;&#10;    plot_pot_temp_time_contours(pot_temp=wrf_pot_temp, model=&quot;WRF&quot;)&#10;&#10;&#10;def plot_hatpro():&#10;    # hatpro = xr.open_dataset(f&quot;{confg.hatpro_folder}/hatpro_merged.nc&quot;)&#10;    # hatpro_temp = hatpro[&quot;temperature&quot;].sel(height=slice(0, 4400))  # select up to 4.400 m&#10;    # plot_temp_time_contours(temp=hatpro_temp, model=&quot;HATPRO&quot;)&#10;    # hatpro&#10;&#10;    # try with hatpro interpolated data&#10;    hatpro = xr.open_dataset(f&quot;{confg.hatpro_folder}/hatpro_interpolated_arome.nc&quot;)&#10;    hatpro_pot_temp = hatpro[&quot;th&quot;].where(hatpro[&quot;height&quot;] &lt;= interface_height, drop=True)  # hatpro[&quot;th&quot;].sel(height=slice(0, 4400))  # select up to 4.400 m&#10;    plot_pot_temp_time_contours(pot_temp=hatpro_pot_temp, model=&quot;HATPRO&quot;)&#10;&#10;if __name__ == '__main__':&#10;    lat_ibk = 47.259998&#10;    lon_ibk = 11.384167&#10;    interface_height = 2500  # what is max height that should be plotted?&#10;    pal1 = diverging_hcl(palette=&quot;Blue-Red 2&quot;)&#10;&#10;    matplotlib.use('Qt5Agg')  # Use the Qt5Agg backend for interactive plotting&#10;&#10;    #plot_arome()&#10;&#10;    plot_icon()&#10;    plot_icon2te()&#10;&#10;    #plot_ukmo()&#10;    #plot_wrf()&#10;    #plot_hatpro()&#10;    plt.show()" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>